# .htaccess for api.evo-techbd.com subdomain
# Place this in: /home/u379849097/domains/evo-techbd.com/public_html/evobackend/

# Enable RewriteEngine
RewriteEngine On

# Proxy requests to Node.js backend running on port 5000
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ http://localhost:5000/$1 [P,L]

# Enable CORS headers
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, PATCH, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept"
Header always set Access-Control-Allow-Credentials "true"

# Handle preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Increase timeout for long operations (image uploads)
TimeOut 300

# Enable compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
</IfModule>

# Security headers
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "DENY"
Header always set X-XSS-Protection "1; mode=block"

# Disable directory browsing
Options -Indexes

# Set error documents
ErrorDocument 502 "Backend server temporarily unavailable. Please try again."
ErrorDocument 503 "Service temporarily unavailable. Please try again."
